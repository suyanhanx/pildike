!function(){"use strict";function e(){}var t={store:null,root:"object"==typeof global&&global&&global.Math===Math&&global.Array===Array?global:self||window||global||function(){return this}()},n=[],r=[];function i(i,o){var a,s,l,p,c=r;for(p=arguments.length;p-- >2;)n.push(arguments[p]);for(o&&null!=o.children&&(n.length||n.push(o.children),delete o.children);n.length;)if((s=n.pop())&&void 0!==s.pop)for(p=s.length;p--;)n.push(s[p]);else"boolean"==typeof s&&(s=null),(l="function"!=typeof i)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(l=!1)),l&&a?c[c.length-1]+=s:c===r?c=[s]:c.push(s),a=l;var u=new e;return u.nodeName=i,u.children=c,u.attributes=null==o?void 0:o,u.key=null==o?void 0:o.key,void 0!==t.vnode&&t.vnode(u),u}function o(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})}function a(e,t){null!=e&&("function"==typeof e?e(t):e.current=t)}!function(){if(void 0!==window.Reflect&&void 0!==window.customElements&&!window.customElements.hasOwnProperty("polyfillWrapFlushCallback")){var e=HTMLElement;window.HTMLElement=function(){return Reflect.construct(e,[],this.constructor)},HTMLElement.prototype=e.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,e)}}();"function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function s(e){return"[object Array]"===Object.prototype.toString.call(e)}var l=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function p(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function c(e){var t=e.parentNode;t&&t.removeChild(e)}function u(e,t,n,r,i){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)a(n,null),a(r,e);else if("class"!==t||i)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var o in n)o in r||(e.style[o]="");for(var o in r)e.style[o]="number"==typeof r[o]&&!1===l.test(o)?r[o]+"px":r[o]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var s=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,h,s):e.removeEventListener(t,h,s),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!i&&t in e){try{e[t]=null==r?"":r}catch(e){}null!=r&&!1!==r||"spellcheck"==t||e.removeAttribute(t)}else{var p=i&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?p?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"string"==typeof r&&(p?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function h(e){return this._listeners[e.type](t.event&&t.event(e)||e)}var d=0,f=!1,g=!1;function v(e,t,n,r,i,o){var a;if(d++||(f=null!=i&&void 0!==i.ownerSVGElement,g=null!=e&&!("__preactattr_"in e)),s(t)){a=[];var l=null;s(e)?(l=e[0].parentNode,e.forEach(function(e,i){a.push(b(e,t[i],n,r,o))})):t.forEach(function(t){a.push(b(e,t,n,r,o))}),i?a.forEach(function(e){i.appendChild(e)}):s(e)&&e.forEach(function(e){l.appendChild(e)})}else a=b(e,t,n,r,o),i&&a.parentNode!==i&&i.appendChild(a);return--d||(g=!1),a}function b(e,t,n,r,i){var a=e,s=f;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(a=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),y(e,!0))),a.__preactattr_=!0,a;var l,h,d=t.nodeName;if(f="svg"===d||"foreignObject"!==d&&f,d=String(d),(!e||!p(e,d))&&(l=d,(h=f?document.createElementNS("http://www.w3.org/2000/svg",l):document.createElement(l)).normalizedNodeName=l,a=h,e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),y(e,!0)}var v=a.firstChild,m=a.__preactattr_,x=t.children;if(null==m){m=a.__preactattr_={};for(var w=a.attributes,O=w.length;O--;)m[w[O].name]=w[O].value}return!g&&x&&1===x.length&&"string"==typeof x[0]&&null!=v&&void 0!==v.splitText&&null==v.nextSibling?v.nodeValue!=x[0]&&(v.nodeValue=x[0]):(x&&x.length||null!=v)&&function(e,t,n,r,i){var o,a,s,l,u,h=e.childNodes,d=[],f={},g=0,v=0,m=h.length,x=0,w=t?t.length:0;if(0!==m)for(var O=0;O<m;O++){var j=h[O],_=j.__preactattr_,k=w&&_?j._component?j._component.__key:_.key:null;null!=k?(g++,f[k]=j):(_||(void 0!==j.splitText?!i||j.nodeValue.trim():i))&&(d[x++]=j)}if(0!==w)for(var O=0;O<w;O++){l=t[O],u=null;var k=l.key;if(null!=k)g&&void 0!==f[k]&&(u=f[k],f[k]=void 0,g--);else if(!u&&v<x)for(o=v;o<x;o++)if(void 0!==d[o]&&(E=a=d[o],C=i,"string"==typeof(N=l)||"number"==typeof N?void 0!==E.splitText:"string"==typeof N.nodeName?!E._componentConstructor&&p(E,N.nodeName):C||E._componentConstructor===N.nodeName)){u=a,d[o]=void 0,o===x-1&&x--,o===v&&v++;break}u=b(u,l,n,r),s=h[O],u&&u!==e&&u!==s&&(null==s?e.appendChild(u):u===s.nextSibling?c(s):e.insertBefore(u,s))}var E,N,C;if(g)for(var O in f)void 0!==f[O]&&y(f[O],!1);for(;v<=x;)void 0!==(u=d[x--])&&y(u,!1)}(a,x,n,r,g||null!=m.dangerouslySetInnerHTML),function(e,t,n){var r,i=!1,a=e.update;for(r in n)t&&null!=t[r]||null==n[r]||(u(e,r,n[r],n[r]=void 0,f),a&&(delete e.props[r],i=!0));for(r in t)a&&"object"==typeof t[r]?(e.props[o(r)]=t[r],i=!0):"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||(u(e,r,n[r],n[r]=t[r],f),a&&(e.props[o(r)]=t[r],i=!0));e.parentNode&&i&&a&&e.update()}(a,t.attributes,m),f=s,a}function y(e,t){null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||c(e),function(e){e=e.lastChild;for(;e;){var t=e.previousSibling;y(e,!0),e=t}}(e)}var m=function(e){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return t.props=function(e){if(!e||s(e))return{};var t={};return Object.keys(e).forEach(function(n){t[n]=e[n].value}),t}(t.constructor.props),t.data=t.constructor.data||{},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e),n.prototype.connectedCallback=function(){if(!this.constructor.pure){for(var e=this.parentNode;e&&!this.store;)this.store=e.store,e=e.parentNode||e.host;this.store&&this.store.instances.push(this)}this.install(),t.afterInstall&&t.afterInstall(this);var n,r,i=this.attachShadow({mode:"open"});this.css&&i.appendChild((n=this.css(),(r=document.createElement("style")).textContent=n,r)),this.beforeRender(),this.host=v(null,this.render(this.props,!this.constructor.pure&&this.store?this.store.data:this.data),{},!1,null,!1),s(this.host)?this.host.forEach(function(e){i.appendChild(e)}):i.appendChild(this.host),this.installed(),this._isInstalled=!0},n.prototype.disconnectedCallback=function(){if(this.uninstall(),this.store)for(var e=0,t=this.store.instances.length;e<t;e++)if(this.store.instances[e]===this){this.store.instances.splice(e,1);break}},n.prototype.update=function(){this.beforeUpdate(),this.beforeRender(),v(this.host,this.render(this.props,!this.constructor.pure&&this.store?this.store.data:this.data)),this.afterUpdate()},n.prototype.fire=function(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t}))},n.prototype.install=function(){},n.prototype.installed=function(){},n.prototype.uninstall=function(){},n.prototype.beforeUpdate=function(){},n.prototype.afterUpdate=function(){},n.prototype.beforeRender=function(){},n}(HTMLElement),x=function(){function e(e){return-1==e.indexOf("/")&&-1==e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function t(e,t){for(var n=[],r=e.parenthoodMap.get(t);r&&r.path;)n.unshift(r.path),r=e.parenthoodMap.get(r.parent);return n.length?"/"+n.join("/"):""}function n(e,t){this.isProxifyingTreeNow=!1,this.isObserving=!1,this.proxifiedObjectsMap=new Map,this.parenthoodMap=new Map,"boolean"!=typeof t&&(t=!0),this.showDetachedWarning=t,this.originalObject=e,this.cachedProxy=null,this.isRecording=!1,this.userCallback,this.resume=function(){var e=this;this.defaultCallback=function(t){e.isRecording&&e.patches.push(t),e.userCallback&&e.userCallback(t)},this.isObserving=!0}.bind(this),this.pause=function(){this.defaultCallback=function(){},this.isObserving=!1}.bind(this)}return n.deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},n.escapePathComponent=e,n.prototype.generateProxyAtPath=function(n,r,i){var o=this;if(!r)return r;var a={set:function(n,r,i,a){return function(n,r,i,o){var a=t(n,r)+"/"+e(i);if(n.proxifiedObjectsMap.has(o)){var s=n.proxifiedObjectsMap.get(o);n.parenthoodMap.set(s.originalObject,{parent:r,path:i})}var l=n.proxifiedObjectsMap.get(o);l&&!n.isProxifyingTreeNow&&(l.inherited=!0),o&&"object"==typeof o&&!n.proxifiedObjectsMap.has(o)&&(n.parenthoodMap.set(o,{parent:r,path:i}),o=n._proxifyObjectTreeRecursively(r,o,i));var p={op:"remove",path:a};if(void 0===o){if(!Array.isArray(r)&&!r.hasOwnProperty(i))return Reflect.set(r,i,o);Array.isArray(r)&&(p.op="replace",p.value=null);var c=n.proxifiedObjectsMap.get(r[i]);c&&(n.parenthoodMap.delete(r[i]),n.disableTrapsForProxy(c),n.proxifiedObjectsMap.delete(c))}else{if(Array.isArray(r)&&!Number.isInteger(+i.toString()))return"length"!=i&&console.warn("JSONPatcherProxy noticed a non-integer prop was set for an array. This will not emit a patch"),Reflect.set(r,i,o);p.op="add",r.hasOwnProperty(i)&&(void 0!==r[i]||Array.isArray(r))&&(p.op="replace"),p.value=o}var u=Reflect.set(r,i,o);return n.defaultCallback(p),u}(o,n,r,i)},deleteProperty:function(n,r){return function(n,r,i){if(void 0!==r[i]){var o=t(n,r)+"/"+e(i),a=n.proxifiedObjectsMap.get(r[i]);a&&(a.inherited?a.inherited=!1:(n.parenthoodMap.delete(a.originalObject),n.disableTrapsForProxy(a),n.proxifiedObjectsMap.delete(r[i])));var s=Reflect.deleteProperty(r,i);return n.defaultCallback({op:"remove",path:o}),s}}(o,n,r)}},s=Proxy.revocable(r,a);return s.trapsInstance=a,s.originalObject=r,this.parenthoodMap.set(r,{parent:n,path:i}),this.proxifiedObjectsMap.set(s.proxy,s),s.proxy},n.prototype._proxifyObjectTreeRecursively=function(t,n,r){for(var i in n)n.hasOwnProperty(i)&&n[i]instanceof Object&&(n[i]=this._proxifyObjectTreeRecursively(n,n[i],e(i)));return this.generateProxyAtPath(t,n,r)},n.prototype.proxifyObjectTree=function(e){this.pause(),this.isProxifyingTreeNow=!0;var t=this._proxifyObjectTreeRecursively(void 0,e,"");return this.isProxifyingTreeNow=!1,this.resume(),t},n.prototype.disableTrapsForProxy=function(e){if(this.showDetachedWarning){var t="You're accessing an object that is detached from the observedObject tree, see https://github.com/Palindrom/JSONPatcherProxy#detached-objects";e.trapsInstance.set=function(e,n,r){return console.warn(t),Reflect.set(e,n,r)},e.trapsInstance.set=function(e,n,r){return console.warn(t),Reflect.set(e,n,r)},e.trapsInstance.deleteProperty=function(e,t){return Reflect.deleteProperty(e,t)}}else delete e.trapsInstance.set,delete e.trapsInstance.get,delete e.trapsInstance.deleteProperty},n.prototype.observe=function(e,t){if(!e&&!t)throw new Error("You need to either record changes or pass a callback");return this.isRecording=e,this.userCallback=t,e&&(this.patches=[]),this.cachedProxy=this.proxifyObjectTree(this.originalObject),this.cachedProxy},n.prototype.generate=function(){if(!this.isRecording)throw new Error("You should set record to true to get patches later");return this.patches.splice(0,this.patches.length)},n.prototype.revoke=function(){this.proxifiedObjectsMap.forEach(function(e){e.revoke()})},n.prototype.disableTraps=function(){this.proxifiedObjectsMap.forEach(this.disableTrapsForProxy,this)},n}(),w=null,O={},j=function(e,t){if(clearTimeout(w),"remove"===e.op){var n=function(e,t){for(var n=e.replace("/","").split("/"),r=t.data[n[0]],i=1,o=n.length;i<o-1;i++)r=r[n[i]];return{k:function(e){var t="",n=e.replace("/","").split("/"),r=n.length;return n.forEach(function(e,n){n<r-1&&(n?isNaN(Number(e))?t+="."+e:t+="["+e+"]":t+=e)}),t}(e),v:r}}(e.path,t);O[n.k]=n.v,w=setTimeout(function(){_(O,t),O={}})}else{var r=(i=e.path,o="",i.replace("/","").split("/").forEach(function(e,t){t?isNaN(Number(e))?o+="."+e:o+="["+e+"]":o+=e}),o);O[r]=e.value,w=setTimeout(function(){_(O,t),O={}})}var i,o};function _(e,t){t.update(e)}function k(e,t){if(0===e.indexOf(t)){var n=e.substr(t.length,1);if("["===n||"."===n)return!0}return!1}function E(e,t){var n;customElements.define(e,t),t.data&&!t.pure&&(t.updatePath=(function(e,t){Object.keys(e).forEach(function(n){t[n]=!0;var r=Object.prototype.toString.call(e[n]);"[object Object]"===r?N(e[n],n,t):"[object Array]"===r&&C(e[n],n,t)})}(t.data,n={}),n))}function N(e,t,n){Object.keys(e).forEach(function(r){n[t+"."+r]=!0,delete n[t];var i=Object.prototype.toString.call(e[r]);"[object Object]"===i?N(e[r],t+"."+r,n):"[object Array]"===i&&C(e[r],t+"."+r,n)})}function C(e,t,n){e.forEach(function(e,r){n[t+"["+r+"]"]=!0,delete n[t];var i=Object.prototype.toString.call(e);"[object Object]"===i?N(e,t+"["+r+"]",n):"[object Array]"===i&&C(e,t+"["+r+"]",n)})}var P={tag:function(e,t){return function(n){n.pure=t,E(e,n)}},WeElement:m,render:function(e,t,n){t="string"==typeof t?document.querySelector(t):t,n&&(n.instances=[],function(e){e.update=function(e){var t=this,n=function(e,t){if(!e)return!1;for(var n in t){if(e.indexOf(n)>-1)return!0;for(var r=0,i=e.length;r<i;r++)if(k(n,e[r]))return!0}return!1}(this.globalData,e);Object.keys(e).length>0&&(this.instances.forEach(function(r){(n||t.updateAll||r.constructor.updatePath&&function(e,t){for(var n in e){if(t[n])return!0;for(var r in t)if(k(n,r))return!0}return!1}(e,r.constructor.updatePath))&&r.update()}),this.onChange&&this.onChange(e))}}(n),n.data=new x(n.data).observe(!0,function(e){j(e,n)}),t.store=n),v(null,e,{},!1,t,!1)},h:i,createElement:i,options:t,define:E};t.root.Omi=P,t.root.Omi.version="4.0.6";customElements.define("image-uploader",class extends m{install(){this.previewFile=this.previewFile.bind(this),this.inputUpload=this.inputUpload.bind(this),this.ready=this.ready.bind(this),this.images=[]}installed(){["dragenter","dragover","dragleave","drop"].forEach(e=>{this.addEventListener(e,this.preventDefault,!1)}),["drop"].forEach(e=>{this.addEventListener(e,this.handleDrop,!1)}),this.ondragenter=(()=>this.classList.add("highlight")),this.ondragleave=(()=>this.classList.remove("highlight")),this.ondragend=(()=>this.classList.remove("highlight")),this.onclick=(()=>this.shadowRoot.querySelector("#file_uploader").click()),this.shadowRoot.querySelector("#file_uploader").addEventListener("change",this.inputUpload,!1)}ready(e){this.preventDefault(e),this.fire("upload",{images:this.images})}css(){return`:host {\n            display:grid;\n            padding:15px;\n            width:${this.getAttribute("width")};\n          }\n          .highlight {\n            background:#e67e22;\n          }\n          #upload-container.filled {\n            background-image:none;\n          }\n          #upload-container {\n            background-image:url(${this.getAttribute("background")});\n            background-repeat:no-repeat;\n            background-size:contain;\n            background-position:50% 15px;\n            cursor:pointer;\n            position:relative;\n            width:100%;\n            min-width:${this.getAttribute("width")};\n            min-height:500px;\n            display:grid;\n            border:dashed 1px #2c3e50;\n            box-sizing:content-box;\n          }\n          #image-previews {\n            display:grid;\n            grid-template-columns: repeat(3, 0.4fr);\n            grid-auto-rows: max-content;\n            grid-column-gap:20px;\n            grid-row-gap:30px;\n            padding:20px;\n          }\n          #image-previews img {\n            height:150px;\n            width:100%;\n            display:block;\n          }\n          #image-previews .image-info span {\n            font-size:11px;\n            text-align:center;\n            padding:6px 3px;\n          }\n          .image-info {\n            box-shadow: 2px 1px 5px 1px #7f8c8d;\n            display:grid;\n            position:relative;\n          }\n          .delete-image {\n            position: absolute;\n            right: -7px;\n            top: -9px;\n            color: red;\n            background: white;\n            border-radius: 50%;\n            width: 17px;\n            height: 13px;\n            box-shadow: 1px 1px 2px 1px #7f8c8d;\n          }\n          #ready-button {\n            position: absolute;\n            right: -1px;\n            bottom: -40px;\n            background: #4CAF50;\n            font-size: 20px;\n            padding: 5px 10px;\n            width: 105px;\n            text-align: center;\n            color: #fafbfb;\n            border-radius: 4px;\n            transition:0.2s ease-in-out;\n          }\n          #ready-button:hover {\n            background: teal;\n            transition:0.2s ease-in-out;\n          }\n          `}preventDefault(e){e.preventDefault(),e.stopPropagation()}handleDrop(e){this.preventDefault(e),[...e.dataTransfer.files].forEach(e=>this.previewFile(e)),this.classList.remove("highlight")}inputUpload(e){[...e.target.files].forEach(e=>this.previewFile(e))}previewFile(e){let t=new FileReader;t.readAsDataURL(e),t.onloadend=(()=>{const n=Math.floor(1e3*Math.random())+1;this.images.push({name:e.name,id:n,size:e.size,result:t.result,file:e}),this.update()})}removeImage(e,t){this.preventDefault(t),this.images=this.images.filter(t=>t.id!==e.id),this.update()}render(){return Omi.h("div",{id:"upload-container",class:this.images.length>0?"filled":"empty"},Omi.h("input",{id:"file_uploader",type:"file",style:"display:none;",name:"pictures",accept:"{this.getAttribute('accept')}",multiple:!0}),Omi.h("div",{id:"image-previews"},this.images.map(e=>Omi.h("div",{className:"image-info"},Omi.h("span",{onclick:this.removeImage.bind(this,e),className:"delete-image"},"×"),Omi.h("img",{src:e.result}),Omi.h("span",null,e.name)))),Omi.h("div",{id:"ready-button",onclick:this.ready},"Done"))}})}();
